from sklearn.feature_extraction.text import CountVectorizer
import pandas as pd

stopwords = {'english': ['sometimes',
  'mill',
  'other',
  'fifteen',
  'system',
  'had',
  'them',
  'first',
  'from',
  'never',
  'anyone',
  'anything',
  'until',
  'thin',
  'i',
  'name',
  'seeming',
  'former',
  'not',
  'take',
  'toward',
  'whereupon',
  'over',
  'much',
  'con',
  'always',
  'six',
  'between',
  'must',
  'another',
  'sometime',
  'and',
  'was',
  'ourselves',
  'ten',
  'last',
  'hers',
  'be',
  'itself',
  'than',
  'un',
  'out',
  'call',
  'beyond',
  'what',
  'yet',
  'per',
  're',
  'own',
  'would',
  'de',
  'why',
  'any',
  'become',
  'many',
  'a',
  'up',
  'might',
  'down',
  'you',
  'fifty',
  'empty',
  'already',
  'these',
  'hence',
  'keep',
  'made',
  'amoungst',
  'nowhere',
  'anyway',
  'whereas',
  'noone',
  'only',
  'wherever',
  'so',
  'becomes',
  'whenever',
  'here',
  'top',
  'without',
  'none',
  'along',
  'whole',
  'anywhere',
  'thru',
  'my',
  'that',
  'twenty',
  'nothing',
  'ltd',
  'elsewhere',
  'even',
  'detail',
  'cant',
  'yourself',
  'after',
  'front',
  'thereby',
  'done',
  'co',
  'three',
  'cannot',
  'moreover',
  'your',
  'somewhere',
  'latterly',
  'hereby',
  'can',
  'nevertheless',
  'two',
  'before',
  'part',
  'yourselves',
  'sixty',
  'well',
  'could',
  'cry',
  'seems',
  'have',
  'across',
  'among',
  'ie',
  'its',
  'either',
  'however',
  'since',
  'his',
  'show',
  'in',
  'nine',
  'each',
  'she',
  'above',
  'ours',
  'themselves',
  'still',
  'under',
  'give',
  'been',
  'via',
  'being',
  'except',
  'became',
  'thick',
  'around',
  'anyhow',
  'go',
  'mostly',
  'ever',
  'onto',
  'do',
  'next',
  'has',
  'herself',
  'besides',
  'then',
  'hasnt',
  'amount',
  'against',
  'whoever',
  'else',
  'whereby',
  'often',
  'on',
  'eg',
  'who',
  'full',
  'beforehand',
  'bottom',
  'whether',
  'others',
  'put',
  'also',
  'once',
  'everything',
  'found',
  'perhaps',
  'about',
  'seem',
  'her',
  'to',
  'back',
  'side',
  'bill',
  'all',
  'or',
  'otherwise',
  'because',
  'but',
  'will',
  'thereafter',
  'amongst',
  'couldnt',
  'least',
  'me',
  'am',
  'of',
  'beside',
  'sincere',
  'yours',
  'becoming',
  'almost',
  'indeed',
  'with',
  'below',
  'same',
  'describe',
  'for',
  'we',
  'myself',
  'their',
  'see',
  'four',
  'if',
  'off',
  'should',
  'someone',
  'our',
  'may',
  'less',
  'alone',
  'enough',
  'forty',
  'something',
  'therein',
  'due',
  'wherein',
  'throughout',
  'namely',
  'latter',
  'they',
  'move',
  'through',
  'such',
  'whence',
  'serious',
  'whose',
  'an',
  'find',
  'behind',
  'which',
  'at',
  'afterwards',
  'neither',
  'again',
  'too',
  'were',
  'some',
  'mine',
  'thus',
  'formerly',
  'interest',
  'everyone',
  'by',
  'most',
  'though',
  'where',
  'hereafter',
  'us',
  'herein',
  'when',
  'nor',
  'this',
  'hereupon',
  'further',
  'now',
  'it',
  'somehow',
  'rather',
  'there',
  'twelve',
  'how',
  'hundred',
  'third',
  'together',
  'several',
  'eight',
  'into',
  'during',
  'both',
  'he',
  'him',
  'as',
  'while',
  'whatever',
  'within',
  'one',
  'is',
  'whither',
  'nobody',
  'etc',
  'no',
  'although',
  'five',
  'whom',
  'get',
  'himself',
  'those',
  'inc',
  'every',
  'the',
  'are',
  'therefore',
  'meanwhile',
  'fire',
  'everywhere',
  'more',
  'thence',
  'few',
  'please',
  'seemed',
  'thereupon',
  'eleven',
  'very',
  'towards',
  'upon',
  'whereafter',
  'fill'],
 'spanish': ['durante',
  'está',
  'solamente',
  'existe',
  'estuviese',
  'ningunas',
  'trabajan',
  'nuestras',
  'largo',
  'tuvo',
  'haces',
  'pesar',
  'esté',
  'consigo',
  'decir',
  'sino',
  'pasado',
  'después',
  'aseguró',
  'tus',
  'habrías',
  'fueses',
  'podrán',
  'solo',
  'les',
  'diferente',
  'sabe',
  'habéis',
  'pueden',
  'trabaja',
  'hubiesen',
  'van',
  'nuestro',
  'será',
  'porque',
  'dicen',
  'intentan',
  'todas',
  'buenos',
  'ellas',
  'fuese',
  'seas',
  'qué',
  'tenida',
  'cierta',
  'estaríais',
  'manifestó',
  'con',
  'podrían',
  'desde',
  'dado',
  'ella',
  'suyo',
  'llevar',
  'estéis',
  'estuviera',
  'algo',
  'aunque',
  'expresó',
  'esa',
  'mediante',
  'cierto',
  'estuvo',
  'tenías',
  'da',
  'tal',
  'sea',
  'dar',
  'en',
  'seáis',
  'pueda',
  'un',
  'considera',
  'tendrá',
  'tuviéramos',
  'conseguir',
  'alrededor',
  'respecto',
  'habremos',
  'tuviste',
  'cuanto',
  'tuviésemos',
  'nos',
  'hubierais',
  'trabajais',
  'bueno',
  'muy',
  'debido',
  'estabas',
  'teneis',
  'ex',
  'estuviste',
  'siete',
  'junto',
  'actualmente',
  'estuvieses',
  'estan',
  'estarían',
  'cinco',
  'buen',
  'estás',
  'verdadera',
  'debe',
  'nuestros',
  'trabajas',
  'ha',
  'gueno',
  'podrias',
  'de',
  'igual',
  'llegó',
  'mucha',
  'como',
  'tener',
  'sería',
  'tendrían',
  'habíamos',
  'tenemos',
  'a',
  'estuvieseis',
  'arriba',
  'propias',
  'mismos',
  'emplean',
  'muchas',
  'tenido',
  'tendrías',
  'yo',
  'sabeis',
  'nuevo',
  'ningún',
  'eres',
  'habido',
  'estado',
  'nuevos',
  'contra',
  'suyos',
  'estos',
  'alguno',
  'pudo',
  'dejó',
  'luego',
  'parte',
  'estáis',
  'teniendo',
  'haciendo',
  'algún',
  'quedó',
  'erais',
  'os',
  'estarás',
  'pues',
  'varias',
  'éramos',
  'bastante',
  'estais',
  'estés',
  'éste',
  'habríamos',
  'estad',
  'este',
  'hubieron',
  'verdad',
  'fue',
  'agregó',
  'serían',
  'propio',
  'grandes',
  'estuviesen',
  'aquellos',
  'tendréis',
  'otros',
  'embargo',
  'hube',
  'hayan',
  'intento',
  'tu',
  'hubisteis',
  'solas',
  'habré',
  'estuvisteis',
  'estábamos',
  'las',
  'apenas',
  'mío',
  'unas',
  'todos',
  'empleo',
  'tras',
  'tuvieses',
  'ni',
  'haya',
  'tuviesen',
  'estabais',
  'fueran',
  'tengamos',
  'empleais',
  'fueseis',
  'nadie',
  'tuviese',
  'estamos',
  'podriais',
  'tendríamos',
  'estaríamos',
  'demás',
  'otra',
  'una',
  'algunas',
  'tendré',
  'hayas',
  'habíais',
  'menos',
  'pocos',
  'esto',
  'o',
  'tengas',
  'próximo',
  'serás',
  'muchos',
  'vais',
  'hayamos',
  'eras',
  'intentas',
  'partir',
  'podria',
  'habría',
  'cerca',
  'antes',
  'quiere',
  'usais',
  'tendría',
  'él',
  'esta',
  'voy',
  'última',
  'adelante',
  'habréis',
  'lugar',
  'estaré',
  'primer',
  'queremos',
  'haceis',
  'ultimo',
  'quienes',
  'vaya',
  'poner',
  'usamos',
  'hoy',
  'tenga',
  'consigues',
  'veces',
  'había',
  'estar',
  'estuvimos',
  'hay',
  'hubiéramos',
  'seríamos',
  'mías',
  'se',
  'segunda',
  'han',
  'suyas',
  'son',
  'lleva',
  'habrá',
  'e',
  'intentar',
  'estuvieran',
  'dentro',
  'hubiste',
  'tuyos',
  'el',
  'que',
  'estarías',
  'todo',
  'además',
  'has',
  'consigue',
  'hayáis',
  'estuvierais',
  'ejemplo',
  'mía',
  'consideró',
  'tuve',
  'éstos',
  'habidas',
  'cuales',
  'creo',
  'tengo',
  'podrian',
  'tiempo',
  'hubo',
  'propia',
  'fuerais',
  'cómo',
  'dio',
  'casi',
  'mucho',
  'vuestros',
  'habían',
  'habías',
  'tendremos',
  'aquel',
  'así',
  'atras',
  'sólo',
  'haber',
  'incluso',
  'mencionó',
  'cuatro',
  'nosotros',
  'realizó',
  'buena',
  'tercera',
  'por qué',
  'buenas',
  'dicho',
  'hace',
  'través',
  'cual',
  'cuenta',
  'existen',
  'más',
  'también',
  'ocho',
  'dijo',
  'realizado',
  'nunca',
  'ningunos',
  'tiene',
  'ellos',
  'para',
  'y',
  'habrás',
  'verdadero',
  'vuestro',
  'estuviéramos',
  'estemos',
  'poca',
  'deben',
  'poco',
  'hasta',
  'me',
  'fin',
  'nuestra',
  'entonces',
  'hacemos',
  'si',
  'fui',
  'ninguno',
  'lo',
  'hicieron',
  'fuiste',
  'la',
  'pero',
  'estados',
  'ti',
  'ya',
  'tuvieran',
  'explicó',
  'principalmente',
  'sois',
  'ciertos',
  'por',
  'esos',
  'bien',
  'ver',
  'estuviésemos',
  'dice',
  'dijeron',
  'todavía',
  'tenidos',
  'tendrás',
  'sabes',
  'consiguen',
  'tendríais',
  'podriamos',
  'hubieran',
  'donde',
  'habidos',
  'tuvieron',
  'misma',
  'trata',
  'saben',
  'del',
  'sin',
  'primeros',
  'tanto',
  'fuésemos',
  'ampleamos',
  'usas',
  'ésta',
  'segundo',
  'empleas',
  'usan',
  'estaremos',
  'solos',
  'bajo',
  'habríais',
  'intentais',
  'estaba',
  'estén',
  'estuvieras',
  'sí',
  'tengáis',
  'mayor',
  'tuyas',
  'podeis',
  'podría',
  'usa',
  'encima',
  'afirmó',
  'mientras',
  'tú',
  'aproximadamente',
  'momento',
  'mejor',
  'va',
  'nosotras',
  'mi',
  'fuimos',
  'hubimos',
  'parece',
  'realizar',
  'hubiésemos',
  'emplear',
  'estuve',
  'ahora',
  'es',
  'aquellas',
  'quien',
  'eramos',
  'aqui',
  'nuevas',
  'intenta',
  'pasada',
  'hacer',
  'estas',
  'primera',
  'conseguimos',
  'aún',
  'sean',
  'encuentra',
  'usted',
  'valor',
  'siendo',
  'vez',
  'tuya',
  'teníamos',
  'habrán',
  'serán',
  'fuéramos',
  'seamos',
  'últimas',
  'cualquier',
  'tenían',
  'tres',
  'vosotras',
  'tengan',
  'hacen',
  'mismas',
  'uno',
  'habrían',
  'tuviera',
  'mis',
  'entre',
  'cosas',
  'estada',
  'éstas',
  'estoy',
  'tenidas',
  'al',
  'fuera',
  'trabajar',
  'esas',
  'están',
  'intentamos',
  'otras',
  'ese',
  'quién',
  'sola',
  'tenía',
  'tendrán',
  'ciertas',
  'sigue',
  'tuvieras',
  'hubiese',
  'sus',
  'fuisteis',
  'ante',
  'propios',
  'hubieses',
  'tuvimos',
  'seremos',
  'hecho',
  'dan',
  'era',
  'habida',
  'fuesen',
  'vuestras',
  'indicó',
  'seríais',
  'estará',
  'cuando',
  'usar',
  'otro',
  'nada',
  'puede',
  'anterior',
  'tuvisteis',
  'teníais',
  'he',
  'ahí',
  'seréis',
  'varios',
  'estadas',
  'soy',
  'modo',
  'posible',
  'hubiera',
  'serías',
  'señaló',
  'ir',
  'tuvierais',
  'somos',
  'eran',
  'fueras',
  'aquí',
  'sobre',
  'eso',
  'hizo',
  'le',
  'tienes',
  'seis',
  'ninguna',
  'suya',
  'gran',
  'ello',
  'comentó',
  'total',
  'no',
  'hubieseis',
  'tuyo',
  'tened',
  'siempre',
  'unos',
  'conocer',
  'hacerlo',
  'añadió',
  'te',
  'hubieras',
  'primero',
  'su',
  'tuvieseis',
  'vuestra',
  'hemos',
  'ser',
  'podemos',
  'informó',
  'tan',
  'míos',
  'nueva',
  'pocas',
  'hago',
  'mismo',
  'estuvieron',
  'estaban',
  'próximos',
  'dieron',
  'manera',
  'últimos',
  'estaría',
  'poder',
  'habiendo',
  'según',
  'los',
  'estaréis',
  'diferentes',
  'sido',
  'tampoco',
  'mí',
  'saber',
  'lado',
  'podrá',
  'toda',
  'hacia',
  'vamos',
  'dos',
  'cada',
  'alguna',
  'ayer',
  'siguiente',
  'algunos',
  'tienen',
  'vosotros',
  'uso',
  'estarán',
  'tenéis',
  'ambos',
  'último',
  'estando',
  'mio',
  'trabajo',
  'fueron',
  'seré',
  'trabajamos',
  'sabemos',
  'puedo']}

def BagOfWords(df, stopwords):
    vect = CountVectorizer(stop_words=stopwords, ngram_range=(1, 1), max_features=200, token_pattern=r'\b[^\d\W][^\d\W]+\b').fit(df.review_body)
    X = vect.transform(df.review_body)
    reviews_transformed = pd.DataFrame(X.toarray(), columns=vect.get_feature_names())
    #print('Top 5 rows of the DataFrame: \n', reviews_transformed.head())
    return reviews_transformed